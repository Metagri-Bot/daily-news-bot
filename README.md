# Daily News Bot for Discord

## æ¦‚è¦ (Overview)

ã“ã®Botã¯ã€AIã«ã‚ˆã‚‹ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†ææ©Ÿèƒ½ã¨ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®æ´»å‹•ã‚’è‡ªå‹•ã§è¨˜éŒ²ã™ã‚‹ãƒ­ã‚®ãƒ³ã‚°æ©Ÿèƒ½ã‚’å‚™ãˆãŸé«˜æ©Ÿèƒ½Botã§ã™ã€‚å˜ãªã‚‹æƒ…å ±é…ä¿¡ã«ç•™ã¾ã‚‰ãšã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®å¯¾è©±ã‚’æ´»æ€§åŒ–ã•ã›ã€ãã®çŸ¥è¦‹ã‚’è³‡ç”£ã¨ã—ã¦è“„ç©ã™ã‚‹ã“ã¨ã‚’ç›®æŒ‡ã—ã¾ã™ã€‚

1.  **AIç ”ç©¶å“¡ã«ã‚ˆã‚‹å³é¸ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ (æ¯æ—¥ AM 8:00)**:
    å›½å†…ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆã‹ã‚‰ã€Œä¸€æ¬¡ç”£æ¥­ Ã— ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã€ã«é–¢é€£ã™ã‚‹æœ€ã‚‚é‡è¦ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’1ã¤ã ã‘é¸ã³å‡ºã—ã€**AIï¼ˆGPT-4oï¼‰ãŒç”Ÿæˆã—ãŸç‹¬è‡ªã®ã€Œè¦‹è§£ã€ã¨ã€Œå•ã„ã‹ã‘ã€**ã‚’æ·»ãˆã¦æŠ•ç¨¿ã—ã¾ã™ã€‚

2.  **å›½å†…æƒ…å ±åé›†ãƒ˜ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ (AM 6:00 - PM 18:00 / 3æ™‚é–“ã”ã¨)**:
    å¹…åºƒã„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã€**ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°æ–¹å¼**ã§é–¢é€£æ€§ã®é«˜ã„æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’æœ€å¤§3ä»¶æŠ½å‡ºã—ã€æƒ…å ±åé›†ç”¨ã®ãƒãƒ£ãƒ³ãƒãƒ«ã«æŠ•ç¨¿ã—ã¾ã™ã€‚ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®é–¢å¿ƒã«åˆã‚ã›ã¦ã‚¹ã‚³ã‚¢ã‚’èª¿æ•´å¯èƒ½ã§ã™ã€‚

3.  **æµ·å¤–æ–‡çŒ®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆ (æ¯æ—¥ AM 10:00 & PM 19:00)**:
    ä¸–ç•Œã®ä¸»è¦ãªè¾²æ¥­æŠ€è¡“ãƒ»ãƒ“ã‚¸ãƒã‚¹æƒ…å ±æºã‹ã‚‰æœ€æ–°ã®è‹±èªæ–‡çŒ®ã‚’åé›†ã€‚**ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã§å³é¸å¾Œã€è¨˜äº‹æœ¬æ–‡ã‚’ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã—ã€AIãŒæ—¥æœ¬èªã«ç¿»è¨³ãƒ»è¦ç´„**ã—ã¦ã€å°‚é–€ç”¨èªã®è§£èª¬ä»˜ãã§æŠ•ç¨¿ã—ã¾ã™ã€‚

4.  **Robloxé–¢é€£ã®ãƒ“ã‚¸ãƒã‚¹ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆé€Ÿå ± (æ¯æ—¥ AM 7:00):**:
    Robloxé–¢é€£ã®è‹±èªãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã§å³é¸ã—ã€AIãŒãƒ“ã‚¸ãƒã‚¹ã®è¦ç‚¹ã‚’æ—¥æœ¬èªã§ç¿»è¨³ãƒ»è¦ç´„ã—ã¦é…ä¿¡ã—ã¾ã™ã€‚

5.  **æ´»å‹•ãƒ­ã‚°ã®è‡ªå‹•è¨˜éŒ²**:
    æŠ•ç¨¿ã•ã‚ŒãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã§ã®å…¨ç™ºè¨€ã‚’ã€ç™ºè¨€è€…æƒ…å ±ï¼ˆãƒ­ãƒ¼ãƒ«åˆ¤å®šå«ã‚€ï¼‰ã¨å…±ã«Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«è‡ªå‹•ã§è¨˜éŒ²ãƒ»è“„ç©ã—ã¾ã™ã€‚

---

## âœ¨ ä¸»ãªæ©Ÿèƒ½ (Features)

- **AIã«ã‚ˆã‚‹ãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æãƒ»ç¿»è¨³ãƒ»è¦ç´„**: GPT-4oã‚’æ´»ç”¨ã—ã€å›½å†…ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¸ã®ã€Œè¦‹è§£ã€ä»˜ä¸ã‚„ã€æµ·å¤–ã®è‹±èªæ–‡çŒ®ã®é«˜åº¦ãªæ—¥æœ¬èªè¦ç´„ã‚’è‡ªå‹•ç”Ÿæˆã€‚
- **é«˜åº¦ãªã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°æ–¹å¼**: è¤‡æ•°ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚«ãƒ†ã‚´ãƒªï¼ˆæŠ€è¡“ã€æ¶ˆè²»è€…ä½“é¨“ã€ç¤¾ä¼šèª²é¡Œãªã©ï¼‰ã«åŸºã¥ã„ã¦ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’ç‚¹æ•°ä»˜ã‘ã—ã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®é–¢å¿ƒã«åˆè‡´ã—ãŸæƒ…å ±ã‚’é«˜ç²¾åº¦ã§é¸å‡ºã€‚
- **Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°**: RSSãƒ•ã‚£ãƒ¼ãƒ‰ã«æ¦‚è¦ãŒãªã„å ´åˆã§ã‚‚ã€è¨˜äº‹ã®Webãƒšãƒ¼ã‚¸ã‹ã‚‰ç›´æ¥æœ¬æ–‡ã‚’å–å¾—ã—ã€AIã®åˆ†æç²¾åº¦ã‚’å‘ä¸Šã€‚
- **ãƒ‡ãƒ¥ã‚¢ãƒ«å›½å†…ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡**: ç›®çš„ã®ç•°ãªã‚‹2ã¤ã®å›½å†…ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ã‚¿ã‚¹ã‚¯ã‚’ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œã€‚
- **é‡è¤‡æŠ•ç¨¿é˜²æ­¢**: ä¸€åº¦æŠ•ç¨¿ã—ãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ã€å†åº¦æŠ•ç¨¿ã—ãªã„ä»•çµ„ã¿ã‚’æ­è¼‰ã€‚
- **Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æº**: Google Apps Script (GAS) ã‚’Webã‚¢ãƒ—ãƒªã¨ã—ã¦åˆ©ç”¨ã—ã€Discordã§ã®æ´»å‹•ãƒ‡ãƒ¼ã‚¿ã‚’å®‰å…¨ã‹ã¤ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã«è¨˜éŒ²ã€‚
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«åˆ¤å®š**: è­°è«–ã«å‚åŠ ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç‰¹å®šã®ãƒ­ãƒ¼ãƒ«ã‚’æŒã£ã¦ã„ã‚‹ã‹ã‚’åˆ¤å®šã—ã€ãƒ­ã‚°ã«è¨˜éŒ²ã€‚
- **è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤**: GitHubã®mainãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒ—ãƒƒã‚·ãƒ¥ã‚’ãƒˆãƒªã‚¬ãƒ¼ã«ã€GitHub ActionsãŒDockerã‚³ãƒ³ãƒ†ãƒŠã‚’è‡ªå‹•ã§ãƒ“ãƒ«ãƒ‰ï¼†ãƒ‡ãƒ—ãƒ­ã‚¤ã€‚

---

## æ©Ÿèƒ½ã®ä»•çµ„ã¿

### 1. AIç ”ç©¶å“¡ã«ã‚ˆã‚‹å³é¸ãƒ‹ãƒ¥ãƒ¼ã‚¹é…ä¿¡ (æ¯æ—¥ AM 8:00)

AIãŒãƒ•ã‚¡ã‚·ãƒªãƒ†ãƒ¼ã‚¿ãƒ¼ã¨ãªã‚Šã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ã®è³ªã®é«˜ã„è­°è«–ã‚’å‰µå‡ºã—ã¾ã™ã€‚

```mermaid
sequenceDiagram
    participant Scheduler as ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© (Botå†…éƒ¨)
    participant DailyNewsTask as å³é¸ãƒ‹ãƒ¥ãƒ¼ã‚¹æ©Ÿèƒ½
    participant NewsSites as ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆ (RSS)
    participant OpenAI
    participant Discord
    participant GoogleSheets as Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ

    Scheduler->>DailyNewsTask: æ¯æœ8æ™‚ã«å®Ÿè¡Œå‘½ä»¤
    DailyNewsTask->>NewsSites: å…¨ã‚½ãƒ¼ã‚¹ã‹ã‚‰æœ€æ–°è¨˜äº‹ã‚’è¦æ±‚
    NewsSites-->>DailyNewsTask: è¨˜äº‹ãƒªã‚¹ãƒˆã‚’è¿”ã™
    DailyNewsTask->>DailyNewsTask: å¤šæ®µéšãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§1ä»¶ã‚’å³é¸
    DailyNewsTask->>OpenAI: å³é¸ã—ãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’æ¸¡ã—ã€åˆ†æã‚’ä¾é ¼
    OpenAI-->>DailyNewsTask: ã€Œè¦‹è§£ã€ã¨ã€Œå•ã„ã‹ã‘ã€ã‚’ç”Ÿæˆã—ã¦è¿”ã™
    DailyNewsTask->>Discord: ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨AIã®åˆ†æçµæœã‚’æŠ•ç¨¿
    Discord-->>DailyNewsTask: æŠ•ç¨¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æƒ…å ±ã‚’è¿”ã™
    DailyNewsTask->>Discord: å—ã‘å–ã£ãŸæƒ…å ±ã‚’ã‚‚ã¨ã«ã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ä½œæˆ
    DailyNewsTask->>GoogleSheets: æŠ•ç¨¿ãƒ­ã‚°ã¨AIã®åˆ†æçµæœã‚’è¨˜éŒ²
```

### 2. æƒ…å ±åé›†ãƒ˜ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ (AM 6:00 - PM 18:00 / 3æ™‚é–“ã”ã¨)

å€‹äººã®æƒ…å ±åé›†ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã€å¹…åºƒã„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ã‹ã‚‰é–¢é€£æ€§ã®é«˜ã„æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’æœ€å¤§3ä»¶ã€é‡è¤‡ãªãå±Šã‘ç¶šã‘ã¾ã™ã€‚

```mermaid
sequenceDiagram
    participant Scheduler as ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© (Botå†…éƒ¨)
    participant InfoGatheringTask as æƒ…å ±åé›†æ©Ÿèƒ½
    participant GoogleSheets as Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ
    participant NewsSites as ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆ (RSS)
    participant Discord

    Scheduler->>InfoGatheringTask: 3æ™‚é–“ã”ã¨ã«å®Ÿè¡Œå‘½ä»¤
    InfoGatheringTask->>GoogleSheets: æŠ•ç¨¿æ¸ˆã¿URLãƒªã‚¹ãƒˆã‚’è¦æ±‚
    GoogleSheets-->>InfoGatheringTask: URLãƒªã‚¹ãƒˆã‚’è¿”ã™
    InfoGatheringTask->>NewsSites: å…¨ã‚½ãƒ¼ã‚¹ã‹ã‚‰æœ€æ–°è¨˜äº‹ã‚’è¦æ±‚
    NewsSites-->>InfoGatheringTask: è¨˜äº‹ãƒªã‚¹ãƒˆã‚’è¿”ã™
    InfoGatheringTask->>InfoGatheringTask: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° (æŠ•ç¨¿æ¸ˆã¿é™¤å¤–, é®®åº¦, å„ªå…ˆåº¦)
    InfoGatheringTask->>InfoGatheringTask: ä¸Šä½3ä»¶ã‚’é¸å‡º
    InfoGatheringTask->>Discord: ãƒ˜ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³å½¢å¼ã§ãƒ‹ãƒ¥ãƒ¼ã‚¹3ä»¶ã‚’æŠ•ç¨¿
    InfoGatheringTask->>GoogleSheets: æ–°ã—ãæŠ•ç¨¿ã—ãŸURLã‚’è¿½è¨˜
```

### 3. æµ·å¤–æ–‡çŒ®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆ (æ¯æ—¥ AM 10:00 & PM 19:00)

åé›†ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°ã€AIåˆ†æã¨ã„ã†å¤šæ®µéšã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµŒã¦ã€ä¸–ç•Œã®æœ€å…ˆç«¯æƒ…å ±ã‚’å±Šã‘ã¾ã™ã€‚

```mermaid
sequenceDiagram
    participant Scheduler as ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© (Botå†…éƒ¨)
    participant GlobalTask as æµ·å¤–æ–‡çŒ®åé›†æ©Ÿèƒ½
    participant NewsSites as æµ·å¤–RSSãƒ•ã‚£ãƒ¼ãƒ‰
    participant WebPage as è¨˜äº‹ã®Webãƒšãƒ¼ã‚¸
    participant OpenAI
    participant Discord
    participant GoogleSheets as Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ

    Scheduler->>GlobalTask: 1æ—¥2å›å®Ÿè¡Œå‘½ä»¤
    GlobalTask->>NewsSites: æœ€æ–°è¨˜äº‹ã‚’è¦æ±‚
    NewsSites-->>GlobalTask: è¨˜äº‹ãƒªã‚¹ãƒˆã‚’è¿”ã™
    GlobalTask->>GlobalTask: ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã§å€™è£œã‚’å³é¸
    GlobalTask->>WebPage: å€™è£œè¨˜äº‹ã®æœ¬æ–‡ã‚’è¦æ±‚ (ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°)
    WebPage-->>GlobalTask: æœ¬æ–‡ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿”ã™
    GlobalTask->>OpenAI: æœ¬æ–‡ã‚’æ¸¡ã—ã€ç¿»è¨³ãƒ»è¦ç´„ã‚’ä¾é ¼
    OpenAI-->>GlobalTask: æ—¥æœ¬èªã®åˆ†æçµæœã‚’è¿”ã™
    GlobalTask->>Discord: æ•´å½¢ã—ã¦Embedå½¢å¼ã§æŠ•ç¨¿
    GlobalTask->>GoogleSheets: æŠ•ç¨¿ãƒ­ã‚°ã‚’è¨˜éŒ²
```
### 4. Robloxãƒ“ã‚¸ãƒã‚¹ãƒ»ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆé€Ÿå ± (æ¯æ—¥ AM 7:00)

åé›†ã‹ã‚‰AIåˆ†æã€æŠ•ç¨¿ã¾ã§ã‚’è‡ªå‹•åŒ–ã—ã€Robloxã®ãƒ“ã‚¸ãƒã‚¹å‹•å‘ã‚’åŠ¹ç‡çš„ã«ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

```mermaid
sequenceDiagram
    participant Scheduler as ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ© (Botå†…éƒ¨)
    participant RobloxTask as Robloxãƒ‹ãƒ¥ãƒ¼ã‚¹æ©Ÿèƒ½
    participant NewsSites as Robloxé–¢é€£RSS
    participant WebPage as è¨˜äº‹ã®Webãƒšãƒ¼ã‚¸
    participant OpenAI
    participant Discord

    Scheduler->>RobloxTask: æ¯æœ7æ™‚ã«å®Ÿè¡Œå‘½ä»¤
    RobloxTask->>NewsSites: æœ€æ–°è¨˜äº‹ã‚’è¦æ±‚
    NewsSites-->>RobloxTask: è¨˜äº‹ãƒªã‚¹ãƒˆã‚’è¿”ã™
    RobloxTask->>RobloxTask: ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã§å€™è£œã‚’å³é¸
    RobloxTask->>OpenAI: å€™è£œè¨˜äº‹ã‚’æ¸¡ã—ã€ç¿»è¨³ãƒ»è¦ç´„ã‚’ä¾é ¼
    OpenAI-->>RobloxTask: æ—¥æœ¬èªã®åˆ†æçµæœã‚’è¿”ã™
    RobloxTask->>Discord: æ•´å½¢ã—ã¦Embedå½¢å¼ã§æŠ•ç¨¿
```
*ï¼ˆæ³¨ï¼šRobloxãƒ‹ãƒ¥ãƒ¼ã‚¹ã¯ç¾åœ¨ã€ãƒ­ã‚°è¨˜éŒ²ã®å¯¾è±¡å¤–ã§ã™ï¼‰*

#### é¸å®šãƒ­ã‚¸ãƒƒã‚¯ã®è©³ç´°

**ç›®çš„**: ãƒ–ãƒ©ãƒ³ãƒ‰ã®æ´»ç”¨äº‹ä¾‹ã‚„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã®å¤§å‹ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãªã©ã€ãƒ“ã‚¸ãƒã‚¹ä¸Šã®é‡è¦ãƒ‹ãƒ¥ãƒ¼ã‚¹ã«çµã‚Šè¾¼ã¿ã€ãã®è¦ç‚¹ã‚’æ—¥æœ¬èªã§é€Ÿå ±ã™ã‚‹ã€‚

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1.  **ã€è¨˜äº‹åé›†ã€‘**: ç™»éŒ²ã•ã‚ŒãŸRSSãƒ•ã‚£ãƒ¼ãƒ‰ã‹ã‚‰ã€éå»24æ™‚é–“ä»¥å†…ã®Robloxé–¢é€£ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’ã™ã¹ã¦åé›†ã—ã¾ã™ã€‚

2.  **ã€ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã€‘**: åé›†ã—ãŸå„è¨˜äº‹ã‚’ã€ä»¥ä¸‹ã®4ã¤ã®ã‚«ãƒ†ã‚´ãƒªã§è©•ä¾¡ã—ã€ã‚¹ã‚³ã‚¢ã‚’ä»˜ã‘ã¾ã™ã€‚
    *   `ãƒ“ã‚¸ãƒã‚¹/ãƒ–ãƒ©ãƒ³ãƒ‰æ´»ç”¨`: **+5ç‚¹**ï¼ˆ`partnership`, `brand`, `virtual store`ãªã©ï¼‰
    *   `ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ`: **+5ç‚¹**ï¼ˆ`update`, `feature`, `engine`, `studio`ãªã©ï¼‰
    *   `è²¡å‹™/å¸‚å ´å‹•å‘`: **+4ç‚¹**ï¼ˆ`earnings`, `revenue`, `stock`, `investment`ãªã©ï¼‰
    *   `æŠ€è¡“/ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³`: **+3ç‚¹**ï¼ˆ`AI`, `metaverse`, `VR`ãªã©ï¼‰

3.  **ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€‘**: ã‚¹ã‚³ã‚¢ã®åˆè¨ˆãŒ**4ç‚¹æœªæº€**ã®è¨˜äº‹ã¯ã€é‡è¦åº¦ãŒä½ã„ã¨åˆ¤æ–­ã—ã€ã“ã®æ™‚ç‚¹ã§é™¤å¤–ã—ã¾ã™ã€‚

4.  **ã€æœ€çµ‚é¸å®šã€‘**: ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’é€šéã—ãŸè¨˜äº‹ã‚’ã‚¹ã‚³ã‚¢ã®é«˜ã„é †ã«ä¸¦ã¹æ›¿ãˆã€ç¿»è¨³ãƒ»è¦ç´„ã®å¯¾è±¡ã¨ã—ã¦**ä¸Šä½æœ€å¤§5ä»¶**ã‚’é¸å‡ºã—ã¾ã™ã€‚

5.  **ã€AIã«ã‚ˆã‚‹ç¿»è¨³ãƒ»è¦ç´„ã€‘**: é¸å®šã•ã‚ŒãŸè¨˜äº‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã¨æ¦‚è¦ã‚’GPT-4oã«æ¸¡ã—ã€**ã€Œãƒ¡ã‚¿ãƒãƒ¼ã‚¹ã¨ã‚²ãƒ¼ãƒ æ¥­ç•Œã®å°‚é–€ã‚¢ãƒŠãƒªã‚¹ãƒˆã€**ã¨ã„ã†å½¹å‰²ï¼ˆãƒšãƒ«ã‚½ãƒŠï¼‰ã‚’ä¸ãˆã¦ã€ãƒ“ã‚¸ãƒã‚¹ãƒ‘ãƒ¼ã‚½ãƒ³å‘ã‘ã®æ—¥æœ¬èªè¦ç´„ã‚’ç”Ÿæˆã•ã›ã¾ã™ã€‚æ¦‚è¦ãŒçŸ­ã„å ´åˆã§ã‚‚ã€ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰å†…å®¹ã‚’æ¨æ¸¬ã—ã¦è¦ç´„ã‚’ä½œæˆã™ã‚‹ã‚ˆã†ã«æŒ‡ç¤ºã—ã¦ã„ã¾ã™ã€‚

6.  **ã€Discordã¸ã®æŠ•ç¨¿ã€‘**: AIãŒç”Ÿæˆã—ãŸæ—¥æœ¬èªã‚¿ã‚¤ãƒˆãƒ«ã¨è¦ç´„ã‚’ã€ã‚¹ã‚³ã‚¢ã‚„ã‚«ãƒ†ã‚´ãƒªã¨å…±ã«ã€è¦‹ã‚„ã™ã„`Embed`å½¢å¼ã§æŒ‡å®šã•ã‚ŒãŸãƒãƒ£ãƒ³ãƒãƒ«ã«æŠ•ç¨¿ã—ã¾ã™ã€‚

---

## ãƒ‹ãƒ¥ãƒ¼ã‚¹é¸å®šãƒ­ã‚¸ãƒƒã‚¯ã®è©³ç´° (Scoring Logic Details)

ã“ã®Botã®å¿ƒè‡“éƒ¨ã§ã‚ã‚‹ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è‡ªå‹•ã§é¸å®šã™ã‚‹ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚å›½å†…ã¨æµ·å¤–ã§ã€ç›®çš„ã®ç•°ãªã‚‹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

### 1. å›½å†…æƒ…å ±åé›†ãƒ˜ãƒƒãƒ‰ãƒ©ã‚¤ãƒ³ã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

**ç›®çš„**: ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®é–¢å¿ƒï¼ˆãƒ’ãƒˆã€ä½“é¨“ã€ç¤¾ä¼šèª²é¡Œãªã©ï¼‰ã‚’å¤šè§’çš„ã«è©•ä¾¡ã—ã€è­°è«–ã®ãã£ã‹ã‘ã¨ãªã‚Šã‚„ã™ã„å¤šæ§˜ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’é¸å‡ºã™ã‚‹ã€‚

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1.  **ã€å¿…é ˆæ¡ä»¶ã€‘**: ã¾ãšã€è¨˜äº‹ã«`CORE_AGRI_KEYWORDS`ï¼ˆ`'è¾²æ¥­'`, `'è¾²å®¶'`ãªã©ï¼‰ãŒ1ã¤ã§ã‚‚å«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚å«ã¾ã‚Œã¦ã„ãªã„å ´åˆã€ãã®è¨˜äº‹ã¯å‡¦ç†å¯¾è±¡å¤–ã¨ãªã‚Šã¾ã™ã€‚

2.  **ã€ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã€‘**: å¿…é ˆæ¡ä»¶ã‚’ã‚¯ãƒªã‚¢ã—ãŸè¨˜äº‹ã«å¯¾ã—ã€ä»¥ä¸‹ã®ã‚«ãƒ†ã‚´ãƒªã«åˆè‡´ã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚Œã°ã€ãã‚Œãã‚Œç‚¹æ•°ã‚’åŠ ç®—ã—ã¾ã™ã€‚
    *   `æŠ€è¡“é©æ–°`: **+5ç‚¹**
    *   `æ¶ˆè²»è€…ä½“é¨“ãƒ»6æ¬¡ç”£æ¥­åŒ–`: **+5ç‚¹**
    *   `ãƒ’ãƒˆãƒ»äººæãƒ»ã‚¹ãƒˆãƒ¼ãƒªãƒ¼`: **+4ç‚¹**
    *   `ç¤¾ä¼šèª²é¡Œãƒ»ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£`: **+4ç‚¹**
    *   `ãƒ“ã‚¸ãƒã‚¹ãƒ»æ”¿ç­–ãƒ»åˆ¶åº¦`: **+3ç‚¹**
    *   `ã‚³ã‚¢è¾²æ¥­ãƒ»ä¸€æ¬¡ç”£æ¥­`: **+2ç‚¹** (åŸºç¤ç‚¹)
    *   `ãƒœãƒ¼ãƒŠã‚¹ãƒ»ãƒã‚ºãƒ¯ãƒ¼ãƒ‰`: **+2ç‚¹**

3.  **ã€ã‚·ãƒŠã‚¸ãƒ¼ãƒœãƒ¼ãƒŠã‚¹ã€‘**: ã•ã‚‰ã«ã€ç‰¹å®šã®ã‚«ãƒ†ã‚´ãƒªãŒçµ„ã¿åˆã‚ã•ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šä¾¡å€¤ã®é«˜ã„è¨˜äº‹ã¨åˆ¤æ–­ã—ã€ãƒœãƒ¼ãƒŠã‚¹ç‚¹ã‚’åŠ ç®—ã—ã¾ã™ã€‚
    *   `ã‚³ã‚¢è¾²æ¥­` + `æŠ€è¡“é©æ–°` â†’ **+10ç‚¹**
    *   `ã‚³ã‚¢è¾²æ¥­` + `æ¶ˆè²»è€…ä½“é¨“` â†’ **+8ç‚¹**

4.  **ã€æœ€çµ‚é¸å®šã€‘**: å…¨ã‚«ãƒ†ã‚´ãƒªã®ã‚¹ã‚³ã‚¢ã¨ãƒœãƒ¼ãƒŠã‚¹ã‚’åˆè¨ˆã—ã€ã‚¹ã‚³ã‚¢ã®é«˜ã„é †ã«è¨˜äº‹ã‚’ä¸¦ã¹æ›¿ãˆã€ä¸Šä½3ä»¶ã‚’é¸å‡ºã—ã¾ã™ã€‚

---

### 2. æµ·å¤–æ–‡çŒ®ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã®ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

**ç›®çš„**: AgriTechï¼ˆè¾²æ¥­Ã—æŠ€è¡“ï¼‰åˆ†é‡ã®é‡è¦æ–‡çŒ®ã‚’æœ€å„ªå…ˆã§é¸å‡ºã—ã€ä¸–ç•Œã®æœ€å…ˆç«¯ã®ç ”ç©¶é–‹ç™ºå‹•å‘ã‚’æ‰ãˆã‚‹ã“ã¨ã«ç‰¹åŒ–ã™ã‚‹ã€‚

**å‡¦ç†ãƒ•ãƒ­ãƒ¼**:
1.  **ã€å¿…é ˆæ¡ä»¶ã€‘**: å›½å†…ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨åŒæ§˜ã«ã€è¨˜äº‹ã«`GLOBAL_AGRI_KEYWORDS`ï¼ˆ`'agriculture'`, `'farming'`ãªã©ï¼‰ãŒå«ã¾ã‚Œã¦ã„ãªã‘ã‚Œã°ã€å‡¦ç†å¯¾è±¡å¤–ã¨ã—ã¾ã™ã€‚

2.  **ã€ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã€‘**: å¿…é ˆæ¡ä»¶ã‚’ã‚¯ãƒªã‚¢ã—ãŸè¨˜äº‹ã«å¯¾ã—ã€ä»¥ä¸‹ã®ã‚«ãƒ†ã‚´ãƒªã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹ã«å¿œã˜ã¦ã‚¹ã‚³ã‚¢ã‚’ä»˜ä¸ã—ã¾ã™ã€‚
    *   `è¾²æ¥­ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰` (å¿…é ˆ): **+5ç‚¹** (åŸºç¤ç‚¹)
    *   `æŠ€è¡“ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰`: **+5ç‚¹**
    *   `ç ”ç©¶ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰`: **+3ç‚¹**

3.  **ã€Agri-Techã‚·ãƒŠã‚¸ãƒ¼ãƒœãƒ¼ãƒŠã‚¹ã€‘**: ã“ã®ãƒ­ã‚¸ãƒƒã‚¯ã®æœ€ã‚‚é‡è¦ãªéƒ¨åˆ†ã§ã™ã€‚`è¾²æ¥­`ã¨`æŠ€è¡“`ã®ä¸¡æ–¹ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹è¨˜äº‹ã«ã¯ã€ã•ã‚‰ã«**+10ç‚¹**ã®ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã€æœ€å„ªå…ˆã§é¸ã°ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

4.  **ã€æœ€çµ‚é¸å®šã€‘**: åˆè¨ˆã‚¹ã‚³ã‚¢ã®é«˜ã„é †ã«è¨˜äº‹ã‚’ä¸¦ã¹æ›¿ãˆã€ä¸Šä½å€™è£œã‹ã‚‰ç¿»è¨³ãƒ»è¦ç´„ã™ã‚‹è¨˜äº‹ã‚’é¸å‡ºã—ã¾ã™ã€‚

---

## ğŸ› ï¸ ä½¿ç”¨æŠ€è¡“ (Technology Stack)

- **Bot**: Node.js, discord.js, axios, node-cron, rss-parser
- **AI**: OpenAI API (GPT-4o)
- **ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²**: Google Apps Script (GAS), Google Sheets
- **ãƒ‡ãƒ—ãƒ­ã‚¤**: Docker, GitHub Actions

---

## ğŸš€ å°å…¥ãƒ»ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³• (Setup)

### Part 1: Discord Bot & OpenAI APIã®æº–å‚™

1.  **Botã®ä½œæˆ**: [Discord Developer Portal](https://discord.com/developers/applications)ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨Botã‚’ä½œæˆã—ã€**Botãƒˆãƒ¼ã‚¯ãƒ³**ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚
2.  **Message Content Intentã®æœ‰åŠ¹åŒ–**: Developer Portalã®`Bot`ãƒšãƒ¼ã‚¸ã§ã€Œ**MESSAGE CONTENT INTENT**ã€ã‚’**å¿…ãšæœ‰åŠ¹**ã«ã—ã¦ãã ã•ã„ã€‚
3.  **Botã®æ‹›å¾…**: `OAuth2` > `URL Generator`ã§ã€ã‚¹ã‚³ãƒ¼ãƒ—ã«`bot`ã‚’é¸æŠã—ã€å¿…è¦ãªæ¨©é™ï¼ˆ`Send Messages`, `Create Public Threads`, `Embed Links`, `Read Message History`ï¼‰ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã‚µãƒ¼ãƒãƒ¼ã«æ‹›å¾…ã—ã¾ã™ã€‚
4.  **OpenAI APIã‚­ãƒ¼ã®å–å¾—**: [OpenAI Platform](https://platform.openai.com/)ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã€**APIã‚­ãƒ¼**ã‚’å–å¾—ã—ã¾ã™ã€‚

### Part 2: Google Apps Script (GAS) ã®æº–å‚™

1.  **ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ä½œæˆ**: ãƒ­ã‚°è¨˜éŒ²ç”¨ã®æ–°ã—ã„Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚
2.  **GASã®è¨­å®š**:
    - ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ `[æ‹¡å¼µæ©Ÿèƒ½]` > `[Apps Script]` ã‚’é¸æŠã—ã¾ã™ã€‚
    - ã‚¨ãƒ‡ã‚£ã‚¿ã«ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚ï¼ˆ**AIã®åˆ†æçµæœã‚’è¨˜éŒ²ã™ã‚‹é …ç›®ã‚’è¿½åŠ æ¸ˆã¿**ï¼‰

    ```javascript
    function doPost(e) {
      try {
        const data = JSON.parse(e.postData.contents);
        const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
        
        if (data.type === 'discussion') {
          const sheet = getSheetByName(spreadsheet, "User");
          if (sheet.getLastRow() === 0) {
            sheet.appendRow(["æ—¥æ™‚", "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID", "ãƒ¦ãƒ¼ã‚¶ãƒ¼å", "æŠ•ç¨¿å†…å®¹", "å…ƒãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ã‚¿ã‚¤ãƒˆãƒ«", "å…ƒãƒ‹ãƒ¥ãƒ¼ã‚¹ã®URL", "å…ƒãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æŠ•ç¨¿æ—¥", "ãƒ­ãƒ¼ãƒ«"]);
          }
          sheet.appendRow([ new Date(data.timestamp), data.userId, data.username, data.content, data.newsTitle, data.newsUrl, new Date(data.newsPostDate), data.userRole ]);
        } else if (data.type === 'news') {
          const sheet = getSheetByName(spreadsheet, "News");
          if (sheet.getLastRow() === 0) {
            sheet.appendRow(["æŠ•ç¨¿æ—¥æ™‚", "ã‚¿ã‚¤ãƒˆãƒ«", "URL", "ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æ—¥ä»˜", "AIã®è¦‹è§£", "AIã®è³ªå•"]);
          }
          sheet.appendRow([ new Date(), data.title, data.link, data.newsDate, data.metagriInsight, Array.isArray(data.discussionQuestions) ? data.discussionQuestions.join('\n') : data.discussionQuestions ]);
        }
        return ContentService.createTextOutput(JSON.stringify({ "result": "success" })).setMimeType(ContentService.MimeType.JSON);
      } catch (error) {
        return ContentService.createTextOutput(JSON.stringify({ "result": "error", "message": error.message })).setMimeType(ContentService.MimeType.JSON);
      }
    }
    function getSheetByName(spreadsheet, name) { let sheet = spreadsheet.getSheetByName(name); if (!sheet) { sheet = spreadsheet.insertSheet(name); } return sheet; }
    ```
3.  **Webã‚¢ãƒ—ãƒªã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤**:
    - GASã‚¨ãƒ‡ã‚£ã‚¿ä¸Šéƒ¨ã® `[ãƒ‡ãƒ—ãƒ­ã‚¤]` > `[æ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤]` ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚
    - `ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼:` ã‚’ã€Œ**å…¨å“¡**ã€ã«å¤‰æ›´ã—ã€ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚
    - è¡¨ç¤ºã•ã‚ŒãŸ**ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã®URL**ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ãŠãã¾ã™ã€‚

### Part 3: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1.  **ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**
    ```bash
    git clone https://github.com/Metagri-Bot/daily-news-bot.git
    cd daily-news-bot
    npm install
    ```
2.  **`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ**
    - `.env.sample`ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®é …ç›®ã«å€¤ã‚’è¨­å®šã—ã¾ã™ã€‚
      - `DISCORD_BOT_TOKEN`
      - `OPENAI_API_KEY` (**New!**)
      - `NEWS_CHANNEL_ID`
      - `INFO_GATHERING_CHANNEL_ID`
      - `GOOGLE_APPS_SCRIPT_URL`
      - `BIGNER_ROLE_ID`, `METAGRI_ROLE_ID`
      - `NEWS_RSS_FEEDS...`

---

## ğŸš¢ ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³• (Deployment)

`main`ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹ã¨ã€GitHub ActionsãŒè‡ªå‹•ã§ã‚µãƒ¼ãƒãƒ¼ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚
ãƒ‡ãƒ—ãƒ­ã‚¤ã«ã¯ã€ãƒªãƒã‚¸ãƒˆãƒªã®`Settings` > `Secrets and variables` > `Actions`ã«ä»¥ä¸‹ã®æƒ…å ±ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

- `SSH_HOST`, `SSH_USER`, `SSH_PRIVATE_KEY`
- ä¸Šè¨˜`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šã—ãŸã™ã¹ã¦ã®å¤‰æ•° (`DISCORD_BOT_TOKEN`, `OPENAI_API_KEY`, etc.)

---

## âš™ï¸ ä½¿ã„æ–¹ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

- **æŠ•ç¨¿æ™‚é–“ã®å¤‰æ›´**: `index.js`å†…ã®`cron.schedule(...)`ã®æ›¸å¼ã‚’å¤‰æ›´ã—ã¾ã™ã€‚
- **AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®å¤‰æ›´**: `index.js`å†…ã®`generateMetagriInsight`é–¢æ•°ã«ã‚ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç·¨é›†ã—ã¾ã™ã€‚
- **æŠ½å‡ºã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¤‰æ›´**: `index.js`ãƒ•ã‚¡ã‚¤ãƒ«ä¸Šéƒ¨ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é…åˆ—ã‚’ç·¨é›†ã—ã¾ã™ã€‚
- **ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ã®å¤‰æ›´**: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã¾ãŸã¯GitHub Secretsï¼‰ã®`NEWS_RSS_FEEDS_...`ã®å€¤ã‚’å¤‰æ›´ã—ã¾ã™ã€‚

---
## ğŸ—‚ï¸ Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆé€£æºã®è©³ç´°

ã“ã®Botã®å¼·åŠ›ãªæ©Ÿèƒ½ã®ä¸€ã¤ãŒã€Google Apps Script (GAS) ã‚’æ´»ç”¨ã—ãŸé«˜åº¦ãªãƒ‡ãƒ¼ã‚¿ãƒ­ã‚®ãƒ³ã‚°ã¨é›†è¨ˆã§ã™ã€‚Botã¯å˜ã«Discordã«æŠ•ç¨¿ã™ã‚‹ã ã‘ã§ãªãã€ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®æ´»å‹•ã‚’æ°¸ç¶šçš„ãªãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦è“„ç©ã—ã€åˆ†æå¯èƒ½ãªå½¢ã«æ•´å½¢ã—ã¾ã™ã€‚

### ãƒ‡ãƒ¼ã‚¿ã®æµã‚Œã¨å‡¦ç†

```mermaid
graph TD
    subgraph Discord
        A["ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¹ãƒ¬ãƒƒãƒ‰ã§ç™ºè¨€"] --> B{"BotãŒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¤œçŸ¥"};
    end

    subgraph "Node.js (Botã‚µãƒ¼ãƒãƒ¼)"
        B --> C["ç™ºè¨€ãƒ‡ãƒ¼ã‚¿ã‚’æ•´å½¢"];
        C --> D["GAS Webã‚¢ãƒ—ãƒªã¸POST"];
    end

    subgraph "Google Apps Script (GAS)"
        D --> E["doPosté–¢æ•°ãŒãƒ‡ãƒ¼ã‚¿å—ä¿¡"];
        E --> F["ã‚·ãƒ¼ãƒˆã«ãƒ­ã‚°ã‚’è¿½è¨˜"];
        G["å®šæ™‚å®Ÿè¡Œãƒˆãƒªã‚¬ãƒ¼ (æ¯æ—¥17æ™‚å°)"] --> H["ãƒ‡ãƒ¼ã‚¿é›†è¨ˆãƒ»è»¢è¨˜å‡¦ç†"];
        H --> I["ã‚·ãƒ¼ãƒˆã‹ã‚‰å…¨ãƒ­ã‚°èª­è¾¼"];
        I --> J["æœ€æ–°æ—¥ã®æŠ•ç¨¿ã®ã¿æŠ½å‡º"];
        J --> K["ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒ–"];
        K --> L["ãƒ­ãƒ¼ãƒ«åˆ¥ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°"];
        L --> M["å¤–éƒ¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸POST"];
    end
    
    subgraph "Google ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ (ãƒ­ã‚°ç”¨)"
        F --> Sheet1(["Userã‚·ãƒ¼ãƒˆ"]);
        F --> Sheet2(["Posted_URLsã‚·ãƒ¼ãƒˆ"]);
        I --> Sheet1;
    end

    subgraph "Google ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ (å¤–éƒ¨é€£æºç”¨)"
        M --> Sheet3(["Role 0 è»¢è¨˜å…ˆ"]);
        M --> Sheet4(["Role 1 è»¢è¨˜å…ˆ"]);
    end
```

### GASãŒæ‹…ã†ä¸»ãªå½¹å‰²

1.  **ãƒ‡ãƒ¼ã‚¿å—ä¿¡API (`doPost`, `doGet`)**:
    - Node.jsã‹ã‚‰é€ä¿¡ã•ã‚Œã‚‹HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚‹çª“å£ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚
    - æŠ•ç¨¿ã•ã‚ŒãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æƒ…å ±ã€ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®è­°è«–å†…å®¹ã€æƒ…å ±åé›†ã‚¿ã‚¹ã‚¯ã§æŠ•ç¨¿ã—ãŸè¨˜äº‹ã®URLãªã©ã€æ§˜ã€…ãªç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€é©åˆ‡ãªå‡¦ç†ã«æŒ¯ã‚Šåˆ†ã‘ã¾ã™ã€‚

2.  **ä¸€æ¬¡ãƒ­ã‚°ã®è¨˜éŒ²**:
    - **`User`ã‚·ãƒ¼ãƒˆ**: ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã§ã®å…¨ç™ºè¨€ã‚’ã€ç™ºè¨€è€…ã€å†…å®¹ã€ã©ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã«å¯¾ã™ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã‹ã€ã¨ã„ã£ãŸè©³ç´°æƒ…å ±ã¨å…±ã«æ™‚ç³»åˆ—ã§è¨˜éŒ²ã—ã¾ã™ã€‚
    - **`News`ã‚·ãƒ¼ãƒˆ**: æ¯æœ8æ™‚ã«æŠ•ç¨¿ã•ã‚Œã‚‹å³é¸ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®å±¥æ­´ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚
    - **`Posted_URLs`ã‚·ãƒ¼ãƒˆ**: æƒ…å ±åé›†ã‚¿ã‚¹ã‚¯ã§æŠ•ç¨¿ã—ãŸãƒ‹ãƒ¥ãƒ¼ã‚¹ã®URLã‚’è¨˜éŒ²ã—ã€æ°¸ç¶šçš„ãªé‡è¤‡æŠ•ç¨¿é˜²æ­¢ã«åˆ©ç”¨ã—ã¾ã™ã€‚

3.  **å®šæ™‚ãƒ‡ãƒ¼ã‚¿é›†è¨ˆã¨å¤–éƒ¨é€£æº (`processAndTransferAllUserData`)**:
    - æ¯æ—¥17æ™‚å°ã«è‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹ãƒˆãƒªã‚¬ãƒ¼ã«ã‚ˆã£ã¦ã€ä»¥ä¸‹ã®é«˜åº¦ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚
    - **æœ€æ–°æ—¥ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡º**: `User`ã‚·ãƒ¼ãƒˆã®å…¨ãƒ­ã‚°ã‹ã‚‰ã€**ãã®æ—¥ã«è¡Œã‚ã‚ŒãŸæœ€æ–°ã®æŠ•ç¨¿**ã ã‘ã‚’æŠ½å‡ºã—ã¾ã™ã€‚æŠ•ç¨¿ãŒãªã‹ã£ãŸæ—¥ã¯ã€ã“ã®æ™‚ç‚¹ã§å‡¦ç†ã‚’ä¸­æ–­ã—ã€å¤–éƒ¨ã‚·ãƒ¼ãƒˆã‚’æ›´æ–°ã—ã¾ã›ã‚“ã€‚
    - **ãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼åŒ–**: æœ€æ–°æ—¥ã®æŠ•ç¨¿ãƒ‡ãƒ¼ã‚¿ã®ä¸­ã‹ã‚‰ã€å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æœ€å¾Œã®ç™ºè¨€ã ã‘ã‚’æ®‹ã—ã€é‡è¤‡ã‚’é™¤å¤–ã—ã¾ã™ã€‚
    - **ãƒ­ãƒ¼ãƒ«åˆ¥ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°**: æŠ½å‡ºã•ã‚ŒãŸãƒ¦ãƒ‹ãƒ¼ã‚¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ã€Discordãƒ­ãƒ¼ãƒ« (`0` or `1`) ã«åŸºã¥ã„ã¦2ã¤ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«åˆ†é¡ã—ã¾ã™ã€‚
    - **å¤–éƒ¨ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸ã®è»¢è¨˜**: åˆ†é¡ã•ã‚ŒãŸå„ã‚°ãƒ«ãƒ¼ãƒ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã€ãã‚Œãã‚ŒæŒ‡å®šã•ã‚ŒãŸåˆ¥ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«æ•´å½¢ã—ã¦ä¸Šæ›¸ãè»¢è¨˜ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã¨ã®é€£æºç”¨ã«å¸¸ã«ã‚¯ãƒªãƒ¼ãƒ³ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ç¶­æŒã—ã¾ã™ã€‚

---

## âš™ï¸ ä½¿ã„æ–¹ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

- **ã‚¹ã‚³ã‚¢ã®èª¿æ•´**:
  `index.js`ãƒ•ã‚¡ã‚¤ãƒ«ä¸Šéƒ¨ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚«ãƒ†ã‚´ãƒªå®šç¾©ã‚¨ãƒªã‚¢ã§ã€å„ã‚«ãƒ†ã‚´ãƒªã®**ç‚¹æ•°ã‚’å¤‰æ›´ã™ã‚‹**ã“ã¨ã§ã€ãƒ‹ãƒ¥ãƒ¼ã‚¹é¸å®šã®å‚¾å‘ã‚’ç°¡å˜ã«ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã§ãã¾ã™ã€‚
- **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å¤‰æ›´**:
  å›½å†…ç”¨ï¼ˆ`CORE_AGRI_KEYWORDS`ãªã©ï¼‰ã¨æµ·å¤–ç”¨ï¼ˆ`GLOBAL_AGRI_KEYWORDS`ãªã©ï¼‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰é…åˆ—ã‚’ç·¨é›†ã™ã‚‹ã“ã¨ã§ã€åé›†ã™ã‚‹æƒ…å ±ã®ç¯„å›²ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

---

## ğŸ¯ æ–°æ©Ÿèƒ½: ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãƒ‹ãƒ¥ãƒ¼ã‚¹ç²¾åº¦å‘ä¸Šã‚·ã‚¹ãƒ†ãƒ 

ã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã¯ã€ä»¥ä¸‹ã®3ã¤ã®é«˜åº¦ãªæ©Ÿèƒ½ãŒè¿½åŠ ã•ã‚Œã€ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ç²¾åº¦ã¨é–¢é€£æ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã—ãŸã€‚

### 1. ğŸ§  ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ™ãƒ¼ã‚¹ã®å‹•çš„ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°

**æ¦‚è¦**: éå»ã®è¨˜äº‹ã«å¯¾ã™ã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®åå¿œï¼ˆã‚¹ãƒ¬ãƒƒãƒ‰æŠ•ç¨¿æ•°ã€ã‚³ãƒ¡ãƒ³ãƒˆé•·ï¼‰ã‚’å­¦ç¿’ã—ã€ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã«åæ˜ ã—ã¾ã™ã€‚

**ä»•çµ„ã¿**:
- Google Sheetsã‹ã‚‰éå»ã®è­°è«–ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
- æŠ•ç¨¿æ•°ãŒå¤šã„è¨˜äº‹ï¼ˆ3ä»¶ä»¥ä¸Šï¼‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ
- å¹³å‡æŠ•ç¨¿æ•°ã«å¿œã˜ã¦ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒŠã‚¹ã‚’ä»˜ä¸:
  - 10ä»¶ä»¥ä¸Š: +20% ãƒœãƒ¼ãƒŠã‚¹
  - 5-9ä»¶: +15% ãƒœãƒ¼ãƒŠã‚¹
  - 3-4ä»¶: +10% ãƒœãƒ¼ãƒŠã‚¹
- é•·æ–‡ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆå¹³å‡200æ–‡å­—ä»¥ä¸Šï¼‰ã®è¨˜äº‹ã«ã¯è¿½åŠ ã§ +10% ãƒœãƒ¼ãƒŠã‚¹

**åŠ¹æœ**:
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®é–¢å¿ƒã«è‡ªå‹•é©å¿œ
- è­°è«–ã‚’ç”Ÿã¿å‡ºã—ã‚„ã™ã„è¨˜äº‹ã‚’å„ªå…ˆçš„ã«é¸å‡º
- æ‰‹å‹•ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰èª¿æ•´ã®å·¥æ•°å‰Šæ¸›

### 2. ğŸ” é«˜åº¦ãªé‡è¤‡è¨˜äº‹æ¤œå‡ºã‚·ã‚¹ãƒ†ãƒ 

**æ¦‚è¦**: ã‚¿ã‚¤ãƒˆãƒ«ã®é¡ä¼¼åº¦ã‚’è¨ˆç®—ã—ã€é‡è¤‡ã¾ãŸã¯é¡ä¼¼è¨˜äº‹ã‚’è‡ªå‹•æ¤œå‡ºãƒ»é™¤å¤–ã—ã¾ã™ã€‚

**ä»•çµ„ã¿**:
- ãƒ¬ãƒ¼ãƒ™ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³è·é›¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§æ–‡å­—åˆ—ã®é¡ä¼¼åº¦ã‚’æ¸¬å®š
- ã‚¿ã‚¤ãƒˆãƒ«ãŒ70%ä»¥ä¸Šé¡ä¼¼ã—ã¦ã„ã‚‹è¨˜äº‹ã‚’è‡ªå‹•æ¤œå‡º
- é¡ä¼¼è¨˜äº‹ã‚°ãƒ«ãƒ¼ãƒ—ã®ä¸­ã§æœ€ã‚‚ã‚¹ã‚³ã‚¢ã®é«˜ã„è¨˜äº‹ã®ã¿ã‚’æ®‹ã™

**ä¾‹**:
```
è¨˜äº‹A: ã€ŒAIè¾²æ¥­ãƒ­ãƒœãƒƒãƒˆã€åŒ—æµ·é“ã§å®Ÿè¨¼å®Ÿé¨“é–‹å§‹ã€
è¨˜äº‹B: ã€ŒAIè¾²æ¥­ãƒ­ãƒœãƒƒãƒˆãŒåŒ—æµ·é“ã§å®Ÿè¨¼å®Ÿé¨“ã€
â†’ é¡ä¼¼åº¦: 85% â†’ é‡è¤‡ã¨ã—ã¦æ¤œå‡º
```

**åŠ¹æœ**:
- åŒã˜ãƒˆãƒ”ãƒƒã‚¯ã®è¨˜äº‹ãŒè¤‡æ•°æŠ•ç¨¿ã•ã‚Œã‚‹ã“ã¨ã‚’é˜²æ­¢
- æƒ…å ±ã®å¤šæ§˜æ€§ã‚’å‘ä¸Š
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®æ”¹å–„

### 3. ğŸ“Š ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ†æã¨ãƒˆãƒ¬ãƒ³ãƒ‰è¿½è·¡

**æ¦‚è¦**: éå»7æ—¥é–“ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹å‚¾å‘ã‚’åˆ†æã—ã€AIåˆ†ææ™‚ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦æ´»ç”¨ã—ã¾ã™ã€‚

**ä»•çµ„ã¿**:
- Google Sheetsã‹ã‚‰éå»7æ—¥é–“ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹å±¥æ­´ã‚’å–å¾—
- å…¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®å‡ºç¾é »åº¦ã‚’é›†è¨ˆã—ã€ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¯ãƒ¼ãƒ‰ã‚’æŠ½å‡º
- GPT-4oã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã«ãƒˆãƒ¬ãƒ³ãƒ‰æƒ…å ±ã‚’è¿½åŠ :
  - ã€Œéå»7æ—¥é–“ã§ã€ãƒ‰ãƒ­ãƒ¼ãƒ³ã€(8å›)ã€ã€AIã€(12å›)ãŒæ³¨ç›®ãƒˆãƒ”ãƒƒã‚¯ã€
  - ã€Œä»Šå›ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒç¶™ç¶šãƒˆãƒ¬ãƒ³ãƒ‰ã‹ã€æ–°å±•é–‹ã‹ã‚’è€ƒæ…®ã—ãŸåˆ†æã€

**åŠ¹æœ**:
- ã‚ˆã‚Šæ–‡è„ˆã«å³ã—ãŸAIåˆ†æ
- ãƒˆãƒ¬ãƒ³ãƒ‰ã®é€£ç¶šæ€§ã‚„å¤‰åŒ–ã‚’å¯è¦–åŒ–
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®é–¢å¿ƒã®æµã‚Œã‚’æŠŠæ¡

---

## ğŸ› ï¸ Google Apps Script æ‹¡å¼µå®Ÿè£…ã‚¬ã‚¤ãƒ‰

æ–°æ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã«ã¯ã€Google Apps Scriptå´ã«ä»¥ä¸‹ã®2ã¤ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### æ—¢å­˜ã®GASã‚³ãƒ¼ãƒ‰ã¸ã®è¿½åŠ 

æ—¢å­˜ã®`doPost`é–¢æ•°ã«ä»¥ä¸‹ã®å‡¦ç†ã‚’è¿½åŠ ã—ã¦ãã ã•ã„:

```javascript
function doPost(e) {
  try {
    const data = JSON.parse(e.postData.contents);
    const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();

    // === æ—¢å­˜ã®å‡¦ç† ===
    if (data.type === 'discussion') {
      const sheet = getSheetByName(spreadsheet, "User");
      if (sheet.getLastRow() === 0) {
        sheet.appendRow(["æ—¥æ™‚", "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID", "ãƒ¦ãƒ¼ã‚¶ãƒ¼å", "æŠ•ç¨¿å†…å®¹", "å…ƒãƒ‹ãƒ¥ãƒ¼ã‚¹ã®ã‚¿ã‚¤ãƒˆãƒ«", "å…ƒãƒ‹ãƒ¥ãƒ¼ã‚¹ã®URL", "å…ƒãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æŠ•ç¨¿æ—¥", "ãƒ­ãƒ¼ãƒ«"]);
      }
      sheet.appendRow([ new Date(data.timestamp), data.userId, data.username, data.content, data.newsTitle, data.newsUrl, new Date(data.newsPostDate), data.userRole ]);
      return ContentService.createTextOutput(JSON.stringify({ "result": "success" })).setMimeType(ContentService.MimeType.JSON);
    }
    else if (data.type === 'news') {
      const sheet = getSheetByName(spreadsheet, "News");
      if (sheet.getLastRow() === 0) {
        sheet.appendRow(["æŠ•ç¨¿æ—¥æ™‚", "ã‚¿ã‚¤ãƒˆãƒ«", "URL", "ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®æ—¥ä»˜", "AIã®è¦‹è§£", "AIã®è³ªå•"]);
      }
      sheet.appendRow([ new Date(), data.title, data.link, data.newsDate, data.metagriInsight, Array.isArray(data.discussionQuestions) ? data.discussionQuestions.join('\n') : data.discussionQuestions ]);
      return ContentService.createTextOutput(JSON.stringify({ "result": "success" })).setMimeType(ContentService.MimeType.JSON);
    }
    else if (data.type === 'addArticles') {
      const sheet = getSheetByName(spreadsheet, "Posted_URLs");
      if (sheet.getLastRow() === 0) {
        sheet.appendRow(["æŠ•ç¨¿æ—¥æ™‚", "URL", "ã‚¿ã‚¤ãƒˆãƒ«", "è¨˜äº‹ã®æ—¥ä»˜", "å„ªå…ˆåº¦", "ã‚¹ã‚³ã‚¢"]);
      }
      data.articles.forEach(article => {
        sheet.appendRow([new Date(), article.url, article.title, article.pubDate, article.priority, article.score]);
      });
      return ContentService.createTextOutput(JSON.stringify({ "result": "success" })).setMimeType(ContentService.MimeType.JSON);
    }
    else if (data.type === 'globalResearch') {
      const sheet = getSheetByName(spreadsheet, "Global_Research");
      if (sheet.getLastRow() === 0) {
        sheet.appendRow(["æŠ•ç¨¿æ—¥æ™‚", "å…ƒã®ã‚¿ã‚¤ãƒˆãƒ«", "æ—¥æœ¬èªã‚¿ã‚¤ãƒˆãƒ«", "URL", "è¦ç´„", "é‡è¦ãƒã‚¤ãƒ³ãƒˆ", "ç¤ºå”†", "è¨˜äº‹ã®æ—¥ä»˜"]);
      }
      sheet.appendRow([new Date(), data.titleOriginal, data.titleJa, data.link, data.summary, data.keyPoints, data.implications, data.publishDate]);
      return ContentService.createTextOutput(JSON.stringify({ "result": "success" })).setMimeType(ContentService.MimeType.JSON);
    }

    // â˜…â˜…â˜… æ–°æ©Ÿèƒ½1: è­°è«–ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®å–å¾— â˜…â˜…â˜…
    else if (data.type === 'getDiscussionMetrics') {
      const sheet = spreadsheet.getSheetByName("User");
      if (!sheet || sheet.getLastRow() <= 1) {
        return ContentService.createTextOutput(JSON.stringify([])).setMimeType(ContentService.MimeType.JSON);
      }

      const allData = sheet.getRange(2, 1, sheet.getLastRow() - 1, sheet.getLastColumn()).getValues();
      const result = allData.map(row => ({
        timestamp: row[0],
        userId: row[1],
        username: row[2],
        content: row[3],
        newsTitle: row[4],
        newsUrl: row[5],
        newsPostDate: row[6],
        userRole: row[7]
      }));

      return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON);
    }

    // â˜…â˜…â˜… æ–°æ©Ÿèƒ½2: éå»7æ—¥é–“ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾— â˜…â˜…â˜…
    else if (data.type === 'getRecentNews') {
      const days = data.days || 7;
      const sheet = spreadsheet.getSheetByName("News");
      if (!sheet || sheet.getLastRow() <= 1) {
        return ContentService.createTextOutput(JSON.stringify([])).setMimeType(ContentService.MimeType.JSON);
      }

      const allData = sheet.getRange(2, 1, sheet.getLastRow() - 1, sheet.getLastColumn()).getValues();
      const cutoffDate = new Date();
      cutoffDate.setDate(cutoffDate.getDate() - days);

      const recentNews = allData
        .filter(row => new Date(row[0]) >= cutoffDate)
        .map(row => ({
          publishDate: row[0],
          title: row[1],
          url: row[2],
          newsDate: row[3],
          insight: row[4],
          questions: row[5]
        }));

      return ContentService.createTextOutput(JSON.stringify(recentNews)).setMimeType(ContentService.MimeType.JSON);
    }

    return ContentService.createTextOutput(JSON.stringify({ "result": "error", "message": "Unknown type" })).setMimeType(ContentService.MimeType.JSON);

  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({ "result": "error", "message": error.message })).setMimeType(ContentService.MimeType.JSON);
  }
}

function doGet(e) {
  try {
    const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
    const sheet = spreadsheet.getSheetByName("Posted_URLs");

    if (!sheet || sheet.getLastRow() === 0) {
      return ContentService.createTextOutput(JSON.stringify([])).setMimeType(ContentService.MimeType.JSON);
    }

    const data = sheet.getRange(2, 2, sheet.getLastRow() - 1, 1).getValues();
    const urls = data.map(row => row[0]).filter(url => url);

    return ContentService.createTextOutput(JSON.stringify(urls)).setMimeType(ContentService.MimeType.JSON);
  } catch (error) {
    return ContentService.createTextOutput(JSON.stringify({ "result": "error", "message": error.message })).setMimeType(ContentService.MimeType.JSON);
  }
}

function getSheetByName(spreadsheet, name) {
  let sheet = spreadsheet.getSheetByName(name);
  if (!sheet) {
    sheet = spreadsheet.insertSheet(name);
  }
  return sheet;
}
```

### å®Ÿè£…å¾Œã®å‹•ä½œç¢ºèª

1. GASã‚¨ãƒ‡ã‚£ã‚¿ã§ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã‚’ç®¡ç†ã€â†’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ã€Œæ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€ã«æ›´æ–°
2. Botã‚’å†èµ·å‹•ã™ã‚‹ã¨ã€èµ·å‹•æ™‚ã«ä»¥ä¸‹ã®ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™:
   ```
   [Dynamic Scoring] Fetching discussion metrics from sheet...
   [Dynamic Scoring] Loaded metrics for X articles.
   [Context Analysis] Fetching recent news from sheet...
   [Context Analysis] Loaded X news from the past 7 days.
   [Context Analysis] Trending keywords: ã€ŒAIã€(12å›), ã€Œãƒ‰ãƒ­ãƒ¼ãƒ³ã€(8å›)...
   ```

---

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ (License)

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ [MIT License](LICENSE) ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚
